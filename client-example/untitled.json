! Configuration File for keepalived
global_defs {
   notification_email {
     root@localhost
   }
   notification_email_from Alexandre.Cassen@localhost
   smtp_server 127.0.0.1
   smtp_connect_timeout 30
   router_id LVS_DEVEL
}
 vrrp_script chk_nginx {        #监控nginx脚本
    script "killall -0 nginx"   #监控nginx进程
    interval 1                  #监控间隔
    weight -20                  #优先级-2
}
vrrp_instance VI_1 {
    state MASTER                 #主server 
    interface eth0             
    virtual_router_id 80
    priority 100               #优先级
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
        172.16.10.8            #定义vip
    }
    track_script {
        chk_nginx                 #跟踪脚本
    }
    notify_master "/etc/keepalived/notify8.sh master"  #定义邮件通知
    notify_backup "/etc/keepalived/notify8.sh backup"
    notify_fault "/etc/keepalived/notify8.sh fault"
}
                                                                                                                                                            
vrrp_instance VI_2 {
    state BACKUP            #从server
    interface eth0
    virtual_router_id 81
    priority 99
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
        172.16.10.9
    }
    track_script {
        chk_nginx
    }
    notify_master "/etc/keepalived/notify9.sh master" #定义邮件通知
    notify_backup "/etc/keepalived/notify9.sh backup"
    notify_fault "/etc/keepalived/notify9.sh fault"
}